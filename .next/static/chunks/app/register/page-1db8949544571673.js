(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{283:(e,r,t)=>{"use strict";t.d(r,{A:()=>l,O:()=>i});var s=t(5155),o=t(2115),a=t(6671);let n=(0,o.createContext)(void 0),i=e=>{let{children:r}=e,[t,i]=(0,o.useState)(null),[l,c]=(0,o.useState)(!0);(0,o.useEffect)(()=>{try{let e=localStorage.getItem("user");if(e&&"undefined"!==e&&"null"!==e){let r=JSON.parse(e);i(r)}}catch(e){console.error("Error parsing stored user:",e),localStorage.removeItem("user")}finally{c(!1)}},[]);let d=async(e,r,t,s,o)=>{c(!0);try{let n=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:r,phoneNumber:t,password:s})}),l=await n.json();if(!n.ok)return void a.oR.error(l.error||"Registration failed. Please try again.");i(l.user),localStorage.setItem("user",JSON.stringify(l.user)),a.oR.success("Registration successful!"),o&&o()}catch(e){console.error("Registration error:",e),a.oR.error("Unable to connect to server. Please try again.")}finally{c(!1)}},u=async(e,r,t)=>{c(!0);try{let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),o=await s.json();if(!s.ok)return void a.oR.error(o.error||"Login failed. Please check your credentials.");i(o.user),localStorage.setItem("user",JSON.stringify(o.user)),a.oR.success("Welcome back, ".concat(o.user.name,"!")),t&&t()}catch(e){console.error("Login error:",e),a.oR.error("Unable to connect to server. Please try again.")}finally{c(!1)}},m=async e=>{if(t)try{let r=await fetch("/api/emergency-contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,...e})}),s=await r.json();if(!r.ok)return void a.oR.error(s.error||"Failed to add contact");let o=[...t.emergencyContacts||[],s.contact],n={...t,emergencyContacts:o};i(n),localStorage.setItem("user",JSON.stringify(n)),a.oR.success("Emergency contact added successfully")}catch(e){a.oR.error("Failed to add contact")}},f=async e=>{if(t)try{let r=await fetch("/api/emergency-contact",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,contactId:e})}),s=await r.json();if(!r.ok)return void a.oR.error(s.error||"Failed to remove contact");let o=(t.emergencyContacts||[]).filter(r=>r.id!==e),n={...t,emergencyContacts:o};i(n),localStorage.setItem("user",JSON.stringify(n)),a.oR.success("Emergency contact removed")}catch(e){a.oR.error("Failed to remove contact")}},h=async e=>{c(!0);try{await new Promise(e=>setTimeout(e,1e3)),a.oR.success("Password reset link sent to your email")}catch(e){throw a.oR.error(e instanceof Error?e.message:"Password reset failed"),e}finally{c(!1)}};return(0,s.jsx)(n.Provider,{value:{user:t,isLoading:l,isAuthenticated:!!t,register:d,login:u,logout:()=>{i(null),localStorage.removeItem("user"),a.oR.success("You have been logged out")},addEmergencyContact:m,removeEmergencyContact:f,resetPassword:h},children:r})},l=()=>{let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},285:(e,r,t)=>{"use strict";t.d(r,{$:()=>c});var s=t(5155),o=t(2115),a=t(9708),n=t(2085),i=t(9434);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,r)=>{let{className:t,variant:o,size:n,asChild:c=!1,...d}=e,u=c?a.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(l({variant:o,size:n,className:t})),ref:r,...d})});c.displayName="Button"},2523:(e,r,t)=>{"use strict";t.d(r,{p:()=>n});var s=t(5155),o=t(2115),a=t(9434);let n=o.forwardRef((e,r)=>{let{className:t,type:o,...n}=e;return(0,s.jsx)("input",{type:o,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})});n.displayName="Input"},5937:(e,r,t)=>{"use strict";t.d(r,{lV:()=>u,MJ:()=>y,zB:()=>f,eI:()=>g,lR:()=>x,C5:()=>v});var s=t(5155),o=t(2115),a=t(9708),n=t(2177),i=t(9434),l=t(968);let c=(0,t(2085).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,s.jsx)(l.b,{ref:r,className:(0,i.cn)(c(),t),...o})});d.displayName=l.b.displayName;let u=n.Op,m=o.createContext({}),f=e=>{let{...r}=e;return(0,s.jsx)(m.Provider,{value:{name:r.name},children:(0,s.jsx)(n.xI,{...r})})},h=()=>{let e=o.useContext(m),r=o.useContext(p),{getFieldState:t,formState:s}=(0,n.xW)(),a=t(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...a}},p=o.createContext({}),g=o.forwardRef((e,r)=>{let{className:t,...a}=e,n=o.useId();return(0,s.jsx)(p.Provider,{value:{id:n},children:(0,s.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",t),...a})})});g.displayName="FormItem";let x=o.forwardRef((e,r)=>{let{className:t,...o}=e,{error:a,formItemId:n}=h();return(0,s.jsx)(d,{ref:r,className:(0,i.cn)(a&&"text-destructive",t),htmlFor:n,...o})});x.displayName="FormLabel";let y=o.forwardRef((e,r)=>{let{...t}=e,{error:o,formItemId:n,formDescriptionId:i,formMessageId:l}=h();return(0,s.jsx)(a.DX,{ref:r,id:n,"aria-describedby":o?"".concat(i," ").concat(l):"".concat(i),"aria-invalid":!!o,...t})});y.displayName="FormControl",o.forwardRef((e,r)=>{let{className:t,...o}=e,{formDescriptionId:a}=h();return(0,s.jsx)("p",{ref:r,id:a,className:(0,i.cn)("text-sm text-muted-foreground",t),...o})}).displayName="FormDescription";let v=o.forwardRef((e,r)=>{let{className:t,children:o,...a}=e,{error:n,formMessageId:l}=h(),c=n?String(null==n?void 0:n.message):o;return c?(0,s.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",t),...a,children:c}):null});v.displayName="FormMessage"},6616:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(5155),o=t(2115),a=t(5594),n=t(2177),i=t(221),l=t(285),c=t(5937),d=t(2523),u=t(283),m=t(5695),f=t(6874),h=t.n(f);let p=a.z.object({name:a.z.string().min(2,"Name must be at least 2 characters"),email:a.z.string().email("Please enter a valid email"),phoneNumber:a.z.string().min(10,"Phone number must be at least 10 characters"),password:a.z.string().min(8,"Password must be at least 8 characters"),confirmPassword:a.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),g=()=>{let[e,r]=(0,o.useState)(!1),{register:t}=(0,u.A)(),a=(0,m.useRouter)(),f=(0,n.mN)({resolver:(0,i.u)(p),defaultValues:{name:"",email:"",phoneNumber:"",password:"",confirmPassword:""}}),g=async e=>{r(!0),await t(e.name,e.email,e.phoneNumber,e.password,()=>{a.push("/profile")}),r(!1)};return(0,s.jsx)("div",{className:"container max-w-md mx-auto py-12 px-4",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Create Account"}),(0,s.jsx)("p",{className:"text-gray-500 mt-2",children:"Sign up to access safety features and resources"})]}),(0,s.jsx)(c.lV,{...f,children:(0,s.jsxs)("form",{onSubmit:f.handleSubmit(g),className:"space-y-6",children:[(0,s.jsx)(c.zB,{control:f.control,name:"name",render:e=>{let{field:r}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"Full Name"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(d.p,{placeholder:"John Doe",...r})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsx)(c.zB,{control:f.control,name:"email",render:e=>{let{field:r}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"Email"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(d.p,{type:"email",placeholder:"you@example.com",...r})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsx)(c.zB,{control:f.control,name:"phoneNumber",render:e=>{let{field:r}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"Phone Number"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(d.p,{placeholder:"(123) 456-7890",...r})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsx)(c.zB,{control:f.control,name:"password",render:e=>{let{field:r}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"Password"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(d.p,{type:"password",placeholder:"••••••••",...r})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsx)(c.zB,{control:f.control,name:"confirmPassword",render:e=>{let{field:r}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"Confirm Password"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(d.p,{type:"password",placeholder:"••••••••",...r})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsx)(l.$,{type:"submit",className:"w-full",disabled:e,children:e?"Creating account...":"Create account"})]})}),(0,s.jsxs)("div",{className:"text-center text-sm",children:["Already have an account?"," ",(0,s.jsx)(h(),{href:"/login",className:"text-safety-blue hover:underline",children:"Log in"})]})]})})}},7577:(e,r,t)=>{Promise.resolve().then(t.bind(t,6616))},9434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>a});var s=t(2596),o=t(9688);function a(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.QP)((0,s.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[352,753,521,874,441,684,358],()=>r(7577)),_N_E=e.O()}]);